\subsection{Recap: Software Product Lines and Features}
\begin{frame}{\insertsubsection\ \mytitlesource{\fospl}}
	\leftorright{
		\mydefinition{Software Product Line}{
			\begin{itemize}
				\item set of software-intensive systems (aka products)
				\item sharing a common, managed set of features
				\item satisfying the needs of a domain
				\item developed from a common set of core assets (reuse)
			\end{itemize}
		}
		\href{https://commons.wikimedia.org/wiki/File:Geely_assembly_line_in_Beilun,_Ningbo.JPG}{\includegraphics[width=\linewidth,trim=0 50 0 240,clip]{car-manufacturing}}
	}{
		\mydefinition{Feature}{
			\begin{itemize}
				\item domain abstraction
				\item used for communication by stakeholders (e.g., manager, developer, tester, customer, marketing)
				\item specifies differences between products
			\end{itemize}
		}
		\myexample{Examples}{
			\begin{itemize}
				\item \todots
			\end{itemize}
		}
		\todo{scoping?}
		\todo{SPL has been explained, HCS, feature also. only recap here}
	}
\end{frame}

\subsection{Configuring Features}
\begin{frame}{\insertsubsection}
	\todo{examples for simple feature models without (or with few) dependencies}
	
	\todo{Configuring a Sandwich}

	\todo{Configuring ...}
\end{frame}

\xkcd{2369}

\subsection{Configuring Features with Dependencies}
\begin{frame}{\insertsubsection}
	\partofpage{70}{\myexampletight{Configuring a Notebook}{\only<1,3->{\includegraphics[width=\linewidth]{thinkpad-x1-yoga-display}}\only<2|handout:0>{\includegraphics[width=\linewidth]{thinkpad-x1-yoga-display-invalidconf}}}}
\end{frame}

\begin{frame}{\insertsubsection}
	\partofpage{70}{\myexampletight{Still Configuring a Notebook}{\includegraphics[width=\linewidth]{thinkpad-x1-yoga-office}}}
\end{frame}

\begin{frame}{\insertsubsection}
	~\hfill\partofpage{60}{\myexampletight{Configuring a Car}{\includegraphics[width=\linewidth]{toyota-aygo-wheels}}}
\end{frame}

\begin{frame}{\insertsubsection}
	~\hfill\partofpage{60}{\myexampletight{Configuring a Car with a Weird Price}{\centering\includegraphics[width=.55\linewidth]{toyota-aygo-costs}}}
\end{frame}

\begin{frame}{\insertsubsection}
	~\hfill\partofpage{60}{\myexampletight{Configuring a Car with 8 Wheels!}{\includegraphics[width=\linewidth]{toyota-aygo-costs3}}}
\end{frame}

\begin{frame}{\insertsubsection}
	\partofpage{70}{\myexampletight{Configuring a German Car}{\includegraphics[width=\linewidth]{bmw-series1-confassistant-bluetooth}}}
\end{frame}

\subsection{Configurations}

\newcommand{\feat}[1]{{\emph{#1}}}

\begin{frame}{\insertsubsection}
	\leftorright{
		\mydefinition{Configuration}{
			\begin{itemize}
				\item a \emph{configuration} \deutsch{Konfiguration} over a set of features $F$ selects and deselects features in $F$
				\item formally: a pair $(S, D)$ such that $S, D \subseteq F$ and $S, D$ are disjoint ($S \cap D = \varnothing$)
				\item is \emph{complete} \deutsch{vollständig} if all features are covered ($S \cup D = F$) and \emph{partial} \deutsch{partiell} otherwise
				\item a complete configuration is \emph{valid} \deutsch{gültig} if it ``makes sense'' in the domain and \emph{invalid} \deutsch{ungültig} otherwise
    			\item we often abbreviate complete configurations with $S \equiv (S, F \setminus S)$
			\end{itemize}
		}
	}{
		\myexample{A Configurable Database}{
			Feature set $F = \{ConfigDB, Get, Put, Delete,$
			\hspace*{22mm}$Transactions, Windows, Linux\}$
			
			Examples for \emph{complete} configurations:
			\begin{itemize}
				\item \emph{Valid} (read-only database on Windows):
					$(\{C, G, W\}, \{P, D, T, L\})$
				\item \emph{Valid} (fully functional database on Linux):
					$(\{C, G, P, D, T, L\}, \{W\}\}$
				\item \emph{Invalid} ($\lightning$ no operating system):
					$(\{C, G\}, \{P, D, T, W, L\})$
				\item \emph{Invalid} (transactions $\lightning$ read-only database):
					$(\{C, G, T, L\}, \{P, D, W\})$
			\end{itemize}
			Examples for \emph{partial} configurations:
			
			$(\{C, G\}, \{P, D\})$, $(\varnothing, \varnothing)$, \ldots
		}
		
	}
\end{frame}

\subsection{Characterizing Valid Configurations}

\begin{frame}{\insertsubsection}
	\leftorright{
		\mynote{Valid Configuration}{
			A complete configuration over $F$ is valid if it ``makes sense'' in the domain.
			\emph{\color{red}{$\leadsto$ ``makes sense''?}}
		}

		\mydefinition{First Approach: Natural Language}{
			\begin{itemize}
				\item informal description of relationships between features in $F$
				\item a complete configuration $S$ is \emph{valid} if it conforms to the description
    			\item[+] succinct
    			\item[--] sometimes ambiguous, not machine-readable
			\end{itemize}
		}
	}{
		\myexample{A Configurable Database}{
			``A \feat{configurable database} has an API that allows for at least one of the request types \feat{Get}, \feat{Put}, or \feat{Delete}.
			Optionally, the database can support \feat{transactions}, provided that the API allows for Put or Delete requests.
			Also, the database targets a supported operating system, which is either \feat{Windows} or \feat{Linux}.''
		}
	}
\end{frame}

\begin{frame}{\insertsubsection}
	\leftorright{
		\mynote{Valid Configuration}{
			A complete configuration over $F$ is valid if it ``makes sense'' in the domain.
			\emph{\color{red}{$\leadsto$ ``makes sense''?}}
		}

		\mydefinition{Second Approach: Configuration Map}{
			\begin{itemize}
				\item a \emph{configuration map} over $F$ is a set of complete configurations $C \subseteq F$
				\item a complete configuration $S$ is \emph{valid} if it occurs in the configuration map ($S \in C$)
				\item also known as product map
    			\item[+] precise
				\item[--] unreadable, redundant
				\item[--] explodes in size ($0 \leq \abs{C} \leq 2^{\abs{F}}$)
			\end{itemize}
		}
	}{
		\myexample{A Configurable Database}{
			Feature set $F = \{ConfigDB, Get, Put, Delete,$
			\hspace*{22mm}$Transactions, Windows, Linux\}$
			
			Configuration map:
			
			\small
			\leftandright{
				{\color{blue}$\{C,G,W\}$}\\
				$\{C,P,W\}$\\
				$\{C,G,P,W\}$\\
				$\{C,D,W\}$\\
				$\{C,G,D,W\}$\\
				$\{C,P,D,W\}$\\
				$\{C,G,P,D,W\}$\\
				$\{C,P,T,W\}$\\
				$\{C,G,P,T,W\}$\\
				$\{C,D,T,W\}$\\
				$\{C,G,D,T,W\}$\\
				$\{C,P,D,T,W\}$\\
				$\{C,G,P,D,T,W\}$
			}{
				$\{C,G,L\}$\\
				$\{C,P,L\}$\\
				$\{C,G,P,L\}$\\
				$\{C,D,L\}$\\
				$\{C,G,D,L\}$\\
				$\{C,P,D,L\}$\\
				$\{C,G,P,D,L\}$\\
				$\{C,P,T,L\}$\\
				$\{C,G,P,T,L\}$\\
				$\{C,D,T,L\}$\\
				$\{C,G,D,T,L\}$\\
				$\{C,P,D,T,L\}$\\
				{\color{blue}$\{C,G,P,D,T,L\}$}
			}
		}
	}
\end{frame}

\begin{frame}{\insertsubsection}
	\centering
	\includegraphics[width=0.48\linewidth]{products-in-excel}

	\textbf{Can we do better?}
\end{frame}

\subsection{Feature Models}

\newcommand{\dbmpl}{
	\myexampletight{A Configurable Database}{
		\centering
		\featureDiagramConfigurableDatabase

		\featureDiagramLegend
	}
}

\begin{frame}{\insertsubsection\ \mytitlesource{\fospl}}
	\leftorright{
		\dbmpl
	}{
		\mydefinition{Feature Model \deutsch{Feature-Modell}}{
			\begin{itemize}
				\item hierarchy of features
				\item dependencies between features modeled by tree and cross-tree constraints
				\item \emph{tree constraints}: defined by the hierarchy
				\item \emph{cross-tree constraints}: propositional formulas over features
				\item \emph{abstract features} are used to group other features
				\item \emph{concrete features} have an implementation
    			\item also known as feature diagram or feature tree
			\end{itemize}
		}
	}
\end{frame}

\begin{frame}{\insertsubsection\ \mytitlesource{\fospl}}
	\leftorright{
		\dbmpl
	}{
		\mydefinition{Tree Constraints}{
			\begin{itemize}
				\item each feature requires its parent
				\item an \emph{optional feature} can be (de-)selected freely when its parent is selected
				\item a \emph{mandatory feature} is required by its parent
				\item \emph{or group}: at least one feature must be selected when the parent is selected
				\item \emph{alternative group}: exactly one feature must be selected when the parent is selected
			\end{itemize}
		}
		\mydefinition{Cross-Tree Constraints}{
			\begin{itemize}
				\item a list of propositional formulas expressing further dependencies between features
			\end{itemize}
		}
	}
\end{frame}

\begin{frame}{\insertsubsection\ \mytitlesource{\fospl}}
	\leftorright{
		\dbmpl
	}{
		\myexample{Valid Configurations \todo{animate}}{
			\begin{itemize}
				\item \emph{Valid} (read-only database on Windows):
					$(\{C, G, W\}, \{P, D, T, L\})$
				\item \emph{Valid} (fully functional database on Linux):
					$(\{C, G, P, D, T, L\}, \{W\}\}$
				\item \emph{Invalid} ($\lightning$ no operating system):
					$(\{C, G\}, \{P, D, T, W, L\})$
				\item \emph{Invalid} (transactions $\lightning$ read-only database):
					$(\{C, G, T, L\}, \{P, D, W\})$
			\end{itemize}
			
		}
	}
\end{frame}

\begin{frame}{\insertsubsection\ \mytitlesource{\fospl}}
	\leftorright{
		\todo{other feature diagram example(s) which shows off how notation can also be used}
	}{
		\mynote{Notation}{
			\begin{itemize}
				\item abstract and concrete features can be assigned arbitrarily
    			\item groups can be used anywhere
				\item directly below groups, no optional or mandatory markers are allowed
			\end{itemize}
		}
	}
\end{frame}

\subsection{Advantages of Feature Modeling}
\begin{frame}{\insertsubsection}
	\leftandright{
		\textbf{Making Tacit Knowledge Explicit}
		\mynote{Interview with Practitioners \mysource{\href{https://link.springer.com/chapter/10.1007/978-3-319-11653-2_19}{Berger~et~al.~2014}}}{
			\mycite{I think the best [about feature modeling] is you can see relationships, to actually know what configurations are allowed and what are not allowed. That was also not so easy to express in the past [\ldots] This is from the developer’s point of view. But it’s also, we can see that from the, say project development, it’s also important, because before we noticed that \emph{the same functionality was implemented twice} within the same project, basically they haven’t realized that. They implemented the same features.}
		}
	}{
		\textbf{Tool Support for Automation}

		\todo{FeatureIDE, pure::variants screenshot?}
	}
\end{frame}

% advantages over Natural Language, List of Configurations