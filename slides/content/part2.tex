% TODO L04 FEATURE MODELING

\ifuniversity{recording}{\date{April 26, 2023}\setpicture[50]{ovgu-autumn3}\setcopyright{Photo: Hannah Theile (OVGU)}}
\ifuniversity{ulm}{\date{May 4, 2023}\setpicture[200]{may21-south}}
\ifuniversity{magdeburg}{\setpicture[50]{ovgu-autumn3}\setcopyright{Photo: Hannah Theile (OVGU)}}

\author{Elias Kuiter, Thomas Thüm, Timo Kehrer}
\lecture{Feature Modeling}{modeling}

\section{Feature Models and Configurations}
\input{content/04a-featuremodels} % this part is required to compile Part b
\lessonslearned{
	\item features, dependencies between features, and configurations
	\item feature models: abstract and concrete features, tree and cross-tree constraints
	\item tree constraints: optional, mandatory, or group, alternative group
}{ % TODO unify literature pointer (see Lecture 1-3)
	\item \fospl\mysection{2.3}\mypages{26--39}\\--- introduction to feature modeling
	\item Thorsten Berger et al. (2013): \href{https://doi.org/10.1145/2430502.2430513}{A Survey of Variability Modeling in Industrial Practice} % TODO is this really a good fit?

	\item Damir Nešić et al. (2019): \href{https://doi.org/10.1145/3338906.3338974}{Principles of Feature Modeling}
	% TODO refer to Kang et al. for introducing feature models? more references to other SPL books?
}{
	\begin{enumerate}
		\item sketch a feature model with features $A, B, C, D, E, F$ that has exactly those 5 valid configurations (pen and paper preferred):\\~

			\begin{mycolumns}[t,columns=3,animation=none]
				$\{A,B\}$\\
				$\{A,B,D\}$\\~
			\mynextcolumn
				$\{A,C,E\}$\\
				$\{A,C,F\}$\\
			\mynextcolumn
				$\{A,C,E,F\}$\\
			\end{mycolumns}

		\item discuss in groups whether your feature models are syntactically correct and specify exactly the above configurations
	\end{enumerate}

	\uploadpractice
}

\section{Transforming Feature Models}
\input{content/04b-transformations}
\lessonslearned{
	\item to understand large configuration spaces, we need formal semantics and machine-readable representations
	\item propositional formulas satisfy many (though not all) needs for such a representation
}{ % TODO unify literature pointer (see Lecture 1-3)
	\item Don Batory (2005): \href{https://doi.org/10.1007/11554844_3}{Feature Models, Grammars, and Propositional Formulas}
	\item \uvlwebsite\ --- official website for the Universal Variability Language with examples, grammar, literature pointers
	\item Alexander Knüppel et al. (2017): \href{https://doi.org/10.1145/3106237.3106252}{Is There a Mismatch Between Real-World Feature Models and Product-Line Research?}
}{
	\begin{enumerate}
		\item translate the following feature diagram into a propositional formula:

			\begin{center}
				\featureDiagramABCDE

				$D \pimplies B$
			\end{center}

		\item check formulas of your colleagues
	\end{enumerate}

	\uploadpractice
}

\section{Analyzing Feature Models}
\input{content/04c-analyses}
\lessonslearned{
	\item with solvers, we can build reliable configurators for product lines
	\item SAT-based analyses: void feature model, core/dead features, decision propagation
	\item \ssat{}-based analyses: variability factor, feature commonality
}{ % TODO unify literature pointer (see Lecture 1-3)
	\item \fospl\mysection{10.1}\mypages{244--254}\\--- introduction to feature-model analysis
	\item David Benavides et al. (2010): \href{https://doi.org/10.1016/j.is.2010.01.001}{Automated Analysis of Feature Models 20 Years Later: A Literature Review}\\--- old but extensive literature survey
	\item Chico Sundermann et al. (2021): \href{https://doi.org/10.1145/3442391.3442404}{Applications of \#SAT Solvers on Feature Models}\\--- experiments on the scalability of \ssat{} solvers % TODO replace by EMSE paper?
	% TODO we could add the paper about web configurators here
}{
	\begin{center}
		\featureDiagramABCDE
	\end{center}

	think of a constraint that would make exactly one feature dead
%	How can you \ldots
%	\begin{enumerate}
%		\item make this feature model void
%		\item make exactly one feature dead
%	\end{enumerate}
%	\ldots{} by adding one constraint, respectively?
%
%	Name a partial configuration for which only two products exist.
}

\faq{
	\item What is feature modeling? When is it needed?
	\item How can we specify valid combinations of features?
	\item What is a complete, partial, valid, invalid configuration?
	\item What are (dis-)advantages of natural language, configuration map, and feature models?
	\item What is the graphical syntax and semantics of feature models?
	\item Give an example feature model!
}{
	\item What representations of feature models are available? Are they equivalent?
	\item How to represent feature models textually?
	\item What is UVL (used for)?
	\item How to identify whether a configuration is valid?
	\item How to translate feature model into a propositional formula?
	\item What are DIMACS and KConfig (used for)?
	\item Would you recommend Excel for feature model? Why (not)?
}{
	\item Why can configuration become challenging?
	\item How can we identify problems with feature models and configurations?
	\item How can feature models by analyzed? What analyses are available?
	\item What solvers can be used to analyze feature models?
	\item What is the difference between SAT, \ssat, and ALLSAT?
	\item Why are solvers useful when creating configurations?
}

\input{template/footer}

% TODO L05 CONDITIONAL COMPILATION

\ifuniversity{recording}{\date{April 23, 2023}\setpicture[75]{may21-north2}\setcopyright{}}
\ifuniversity{ulm}{\date{May 11, 2023}\setpicture[75]{may21-north2}}
\ifuniversity{magdeburg}{\setpicture[300]{magdeburg-river}\setcopyright{}}

\author{Thomas Thüm, Elias Kuiter, Timo Kehrer}
\lecture{Conditional Compilation}{conditional}

% TODO shall we use conditional compilation with build systems (preprocessors) instead? would require numerous changes in this lecture
\section{Features with Build Systems}
\input{content/05a-buildsystems}
\lessonslearned{
	\item ad-hoc variability is lacking
	\item features with build systems allow for automated generation of products and free feature selection
	\item build systems include entire files, not lines or chunks
}{
	\item \fospl\mychapter{5.2.1}\mypages{105--106}\\--- brief introduction to variability in build scripts
	% TODO add literature? van der Storm T (2004).Variability and component composition. In: Proc. Int’l Conf. Software Reuse (ICSR) Lecture notes in computer science, vol 3107. Springer, pp 157–166
	\item \fospl\mychapter{5.2.3}\mypages{107--108}\\--- variability in build scripts of the Linux kernel
	% TODO add literature? Berger T, She S, Czarnecki K, Wa ̨sowski A (2010a) Feature-to-code mapping in two large product lines. In: Proc. Int’l Software Product Line Conference (SPLC). Lecture Notes in Computer Science, vol 6287. Springer, pp 498–499
	% TODO add literature? Dietrich C, Tartler R, Schröder-Preikschat W, Lohmann D (2012b) Understanding Linux feature distribution. In: Proc. AOSD Workshop on Modularity In Systems Software (MISS). ACM Press, pp 15–20
	% TODO add work on KernelHaven
}{
% example replaced, as this is probably better for the actual exercise
%	Choose a build system and sketch how it may be used to implement this SPL (file structure and build script):
%
%	\begin{center}
%		\small\featureDiagramConfigurableDatabase
%	\end{center}
	\begin{enumerate}
		\item How are features implemented with build systems different from clone-and-own with build systems?
		\item What is the respective granularity?
	\end{enumerate}

	\uploadpractice
}

\section{Features with Preprocessors}
\input{content/05b-preprocessors}
\lessonslearned{
	\item granularity of variability at file level is not sufficient
	\item preprocessors facilitate fine-grained variability within files
	\item a widely applied preprocessor is the C Preprocessor
	\item industrial systems often combine preprocessors and build systems for features (e.g., Linux kernel)
}{
	\item \fospl\mysection{5.3} Preprocessors % TODO add pages?
}{
	\begin{enumerate}
		\item Antenna performs an in-place transformation on implementation artifacts.
		What might be the benefits of using an in-place approach? Do you see any drawbacks?
		\item The preprocessors we have seen so far are also called lexical preprocessors.
		What is emphasized by the notion of lexical and can you think of other preprocessing approaches?
		\item The literature on software product lines has coined the term ``\#ifdef hell''.
		What could be meant with this?
	\end{enumerate}
}

\section{Feature Traceability}
\input{content/05c-traceability}
\lessonslearned{
	\item preprocessor variability suffers from scattering and tangling
	\item feature traceability can be established with tool support (e.g., Feature Commander)
	\item virtual separation of concerns is an alternative to preprocessors (e.g., CIDE)
}{
	\item \fospl\mysection{3.2.2} Feature Traceability % TODO add pages?
	\item \fospl\mychapter{7} Advanced, Tool-Driven Variability Mechanisms % TODO add pages?
}{
	\begin{enumerate}
		\item Why is it beneficial to have feature traceability even for single systems?
		\item Using disciplined annotations, only optional nodes in the abstract syntax tree can be annotated (i.e., assigned to features); if we remove them, no syntax error occurs. What are examples of optional and non-optional (i.e., mandatory) types of nodes in Java?
	\end{enumerate}
}

\faq{
	\item What are problems of ad-hoc approaches for variability?
	%\item What are disadvantages of preference dialogs, command-line options, configuration files, immutable global variables, clone-and-own when implementing features?
	\item How to implement features with build systems?
	\item How is it different from clone-and-own with build systems?
	\item How is the Linux kernel developed in terms of feature model, configuration, and feature mapping?
	\item What are KConfig, MenuConfig, KBuild (used for)?
	\item What are tristate features in Linux?
	\item How to develop new features or variants? Exemplify!
	\item What are (dis)advantages of conditional compilation with build systems?
	\item When (not) to implement features with build systems?
}{
	\item What are different levels of granularity for variability?
	\item Which granularity level supported by each techniques?
	\item What is a preprocessor and how does it work?
	\item What are examples for preprocessors and what are their differences?
	\item What is better in-place or out-of-place preprocessing?
	\item What is the problem with fine-grained variability or undisciplined annotations?
	%\item How do lines of code, number of features, variable code, and nesting depth correlate with each other?
	\item How to develop new features or variants? Exemplify!
	\item What are (dis)advantages of cond.\ comp.\ with preprocessors?
	\item When (not) to implement features with preprocessors?
}{
	\item Which implementation techniques suffer from code scattering, code tangling, missing traceability?
	\item What is feature traceability? What is the feature traceability problem?
	\item What is the difference between problem and solution space?
	\item How can feature traceability be achieved for preprocessor-based product lines?
	\item Can feature traceability be automated for every potential feature of a domain? % TODO not sure how well this is reflected in the slides so far
	\item What is virtual separation of concerns? How is it different from preprocessors or physical separation?
	\item What is the principle of conditional compilation? How can it be implemented? % TODO not sure how well this is reflected in the slides so far
}

\input{template/footer}

% TODO L06 MODULAR FEATURES

\ifuniversity{recording}{\date{May 26, 2023}\setpicture[250]{may21-q37}\setcopyright{}}
\ifuniversity{ulm}{\date{May 25, 2023}\setpicture[250]{may21-q37}}
\ifuniversity{magdeburg}{\setpicture[35]{ovgu-autumn4}\setcopyright{Photo: Hannah Theile (OVGU)}}

\author{Timo Kehrer, Thomas Thüm, Elias Kuiter}
\lecture{Modular Features}{modular}

\section{Components}
\input{content/06a-components}
\lessonslearned{
	\item Modularity = information hiding and data encapsulation
	\item Components foster a modular software architecture and design
	\item Reuse within and beyond product lines
	\item No automated product derivation, glue code is necessary
}{
	\item \szyperski
	\item \fospl, Chapter 4.4
}{
	\begin{itemize}
		%\item Consider the feature traceability problem in a component-based implementation. How would you localize a feature? Does it still suffer from scattering, tangling and replication? % removed this, as this is already covered in the discussion slide now (Thomas)
		%\item We have introduced a simple color component which we reused in our graph implementation. Could we consider the graph library itself as another component? What about its reusability? % I did not get the point here (Thomas)
		\item Why is feature modeling relevant for component-based product lines?
		\item How can product-line engineering help to find the right trade-offs regarding the library scaling problem? % this question is especially helpful, as the LSP is discussed again in the next part
	\end{itemize}
}

\section{Services and Microservices}
\input{content/06b-services}
\lessonslearned{
	\item Services are another kind of module implemented and operated independently of each other 
	\item Microservices have a clear philosophy regarding their size, driven by organizational constraints
	\item Reuse within and beyond product lines
	\item No automated product derivation, orchestration or choreography is necessary
}{
	\item \fospl, Chapter 4.4
}{
	\begin{itemize}
		\item We have talked a lot about promises of microservices. Do you also see any drawbacks?
		\item In a component-based product-line implementation, practitioners often rely on clone-and-own for glue code. How could we handle variability in service orchestrations?
	\end{itemize}
}

\section{Frameworks with Plug-Ins}
\input{content/06c-frameworks}
\lessonslearned{
	\item A framework is open to extension by integrating plug-ins at explicit hot spots.
	\item The framework takes full control over all plug-ins (load-time and run-time).
	\item Enables full automation but requires preplanning effort.
}{
	\item \fospl, Chapter 4.3
}{
	\begin{itemize}
%		\item Remember two fundamental principles in object-oriented programming; how do they relate to frameworks with plug-ins?
%		\begin{itemize}
%			\item Interface Segregation Principle: ``Clients should not be forced to depend upon interfaces that they do not use''.
%			\item Open-Closed Principle: ``Classes should be open for extension but closed for modification''.
%		\end{itemize}
%		\item In general: Where are the limitations of a modular approach?
		\item What are possible extensions for a bike?
		\item How are bike extensions affected by the preplanning problem?
	\end{itemize}

	\only<4->{\centering\pic[width=.9\linewidth]{birdy}}
}

\faq{
	\item What are problems of previous implementation techniques?
	\item How to implement product lines with components?
	\item What is modularity, cohesion, coupling, glue code? Why does it matter?
	\item Why is it hard to find the right size for components?
	\item What is the library scaling problem? How can product-line engineering help?
	\item How to develop new features or variants? Exemplify!
	\item What are (dis)advantages of components?
	\item When (not) to implement product lines with components?
}{
	\item What is a (micro-)service, orchestration, choreography?
	\item What are commonalities and differences between components and services?
	\item How to implement product lines with (micro-)services?
	\item How are microservices related to Conway's law, single responsibility principle, agile development, DevOps?
	\item How to compose services?
	\item How to develop new features or variants? Exemplify!
	\item What are (dis)advantages of services?
	\item When (not) to implement product lines with services?
}{
	\item What are (black-box) frameworks, plug-ins, extension points/hot spots, extensions?
	\item What is inversion of control? Why is it useful?
	\item How to hide implementation details from both, framework and plug-ins? Why is it useful?
	\item How to implement product lines with plug-ins?
	\item How to develop new features or variants? Exemplify!
	\item What are (dis)advantages of plug-ins?
	\item When (not) to implement product lines with plug-ins?
}

\input{template/footer}

% TODO L07 LANGUAGES FOR FEATURES

% TODO lecture has way too much content for 60 minutes (even too much for 90 minutes)

\ifuniversity{recording}{\date{June 2, 2023}\setpicture[325]{may21-q47}\setcopyright{}}
\ifuniversity{ulm}{\date{June 1, 2023}\setpicture[325]{may21-q47}}
\ifuniversity{magdeburg}{\setpicture[100]{ovgu-winter1}\setcopyright{Photo: Hannah Theile (OVGU)}}

\author{Timo Kehrer, Thomas Thüm, Elias Kuiter}
\lecture{Languages for Features}{languages}

\section{Limitations of Object Orientation}
\input{content/07a-limitations-oop}
\lessonslearned{
	\item[] Important problems of previous approaches:
	\begin{itemize}
		\item Inflexible inheritance hierarchies (especially with runtime variability, frameworks, components, services)
		\item Feature traceability (especially with runtime variability, branches, build systems, preprocessors)	
		\item Preplanning problem (esp. with frameworks, components, services)
		\item Cross-cutting issues (esp. with frameworks, components, services)
	\end{itemize}
}{
	\item[] s.\ previous lectures % TODO add ICSE'99 paper
}{
	Looking at our graph implementation serving as running example throughout the course: 
	\begin{itemize}
		\item Which concern is the dominant one regarding modular decomposition? %data structures
		\item What are crosscutting concerns? %color, weight, ...
		\item Can we restructure the implementation to come up with a different decomposition?
	\end{itemize}
}

\section{Feature-Oriented Programming}
\input{content/07b-fop}
\lessonslearned{
	\item Idea: Mixin-based inheritance getting rid of the traditional limitations of inflexible inheritance hierarchies.
	\item Supports encapsulation of (cross-cutting) concerns and feature traceability by design.
	\item Academic approach not widely adopted in industry.
}{
	\item Batory et al.: Scaling Step-Wise Refinement. IEEE Transactions on Software Engineering, 30(6), 2004.
	\item Apel et al.: Language-Independent and Automated Software Composition: The FeatureHouse Experience. IEEE TSE, 39(1), 2013.
	\item \fospl, Chapter 6.1
	\item \featureide, Part 4
}{
	\begin{itemize}
		\item How is class refinement in FOP different from inheritance in OOP?
		\item To some extent, FOP can be considered as static counterpart to the Decorator design pattern in OOP. Why?
		%\item Consider the composition operator in FOP and the merge operator of traditional version control systems. Which are the major differences?
		\item In which sense does FOP violate the classical principles of information hiding and encapsulation of OOP? What are the consequences? % TODO this is actually something that should be rather discussed in the lecture already
		%\item What might be the reasons that FOP has not yet been widely adopted in practice?
	\end{itemize}
}

\section{Aspect-Oriented Programming}
\input{content/07c-aop} % requires 07b-fop
\lessonslearned{
	\small
	\item Idea: \mycite{In programs P, whenever condition C arises, perform action A} % TODO source missing
	\item AspectJ: Sophisticated joint-point model and powerful language to quantify over join points (through pointcuts).
	\item Supports encapsulation of (cross-cutting) concerns and feature traceability by design.
	\item Practical acceptance limited due to fragile-pointcut problem.	
}{
	\item Kiczales et al: Aspect-oriented programming. Proc. Europ. Conf. Object-Oriented Programming. 1997
	\item Filman et al.: Aspect-oriented software development. Addison-Wesley. 2005
	\item \fospl, Chapter 6.2
}{
	\begin{itemize}
		\item Which features particularly benefit from the concept of quantification?
		\item What similarities and differences do you see between FOP and AOP?
		%\item To what extent can FOP and AOP be combined profitably?
	\end{itemize}
}
% TODO I am missing the terms homogeneous and heterogeneous extensions. these terms are useful to distinguish what feature modules and aspects are better at

\faq{
	\item What are problems of previous implementation techniques?
	\item What is the preplanning problem?
	\item What are (crosscutting) concerns?
	\item What is the tyranny of the dominant decomposition?
	\item What are crosscutting concerns when implementing arithmetic expressions?
	\item Why cannot all concerns be modularized with object orientation and design patterns?
}{
	\item What is feature-oriented programming and collaboration-based design? What are collaborations, roles, feature modules, class refinements?
	\item How to compose feature modules?
	\item What is the difference between Mixin and Jampack? What is better?
	\item Why does the order matter when composing feature modules? Where does it come from?
	\item What is the principle of uniformity?
	%\item What are AHEAD/FeatureHouse? How are they different?
	\item How to implement product lines with feature modules?
	\item How to develop new features or variants? Exemplify!
	\item What are (dis)advantages of feature modules?
	%\item When (not) to implement product lines with feature modules?
}{
	\item What is aspect-oriented programming? What are aspects, aspect weaving, join points, pointcuts, pieces of advice, AspectJ?
	\item What are static/dynamic extensions, quantification, before/after/around advice, inter-type declarations?
	\item What is aspect precedence (good for)? How is it different from feature modules?
	\item What are obliviousness and fragile-pointcut problem?
	\item What are commonalities and differences between feature modules and aspects?
	\item How to implement product lines with aspects?
	%\item How to develop new features or variants? Exemplify!
	\item What are (dis)advantages of aspects?
	%\item When (not) to implement product lines with aspects?
}

\input{template/footer}

% TODO L08 DEVELOPMENT PROCESS

\ifuniversity{recording}{\date{June 14, 2023}\setpicture[250]{may21-west1}\setcopyright{}}
\ifuniversity{ulm}{\date{June 15, 2023}\setpicture[250]{may21-west1}}
\ifuniversity{magdeburg}{\setpicture[15]{ovgu-winter2}\setcopyright{Photo: Hannah Theile (OVGU)}}

\author{Thomas Thüm, Elias Kuiter, Timo Kehrer}
\lecture{Development Process}{process}

\section{Process Model for Product Lines}
\input{content/08a-domainengineering}
\lessonslearned{
	\item domain engineering: domain analysis, domain design, domain implementation, domain testing
	\item application engineering: application analysis, application design, application implementation, application testing
	\item domain scoping, product-line requirements, product requirements
	\item problem space and solution space
}{
	\item \fospl % TODO which chapters?
	\item \sple % TODO which chapters?
}{
	\begin{enumerate}
		\item Where to spend more resources in domain engineering or in application engineering?
		\item What should not be done in domain engineering?
	\end{enumerate}
}

\section{Implementation of Product Lines}
\input{content/08b-techniques}
\lessonslearned{
	\item nine implementation techniques
	\item + three implementation strategies for runtime variability / clone-and-own
	\item + three configuration strategies for runtime variability
	\item choice based on four criteria, but there are more
}{
	\item[] \fospl % TODO which chapters?
}{
	\begin{enumerate}
		\item Which techniques enable interfaces between features?
		\item Which techniques require most code clones?
		\item Which techniques can modularize cross-cutting concerns?
	\end{enumerate}
}

% TODO would be great to repeat the previous slide here again for the exercise and then introduce a new slide with a similar table containing the solution to the task

\section{Adoption of Product Lines}
\input{content/08c-adoption}
\lessonslearned{
	\item adoption strategies to introduce a product line
	\item proactive, extractive, reactive
	\item all applied in practice
}{
	\item[] \fospl\mypages{39--42}
}{
	Are combinations of the adoption strategies feasible?
}

\faq{
	\item How do process models for single-system engineering differ to those for product-line engineering?
	\item What are the two main phases when developing product lines?
	\item What are (the phases in) domain and application engineering?
	\item What is happening in which phase?
	\item How do phases interplay with each other?
	\item What is domain scoping? Why is it relevant?
	\item What is the difference between problem and solution space?
}{
	\item How to implement product lines?
	\item Which implementation techniques exist? What are further variations of those techniques?
	\item How to develop new features or variants? Exemplify!
	\item What are (dis)advantages of each technique?
	\item When to prefer one implementation technique over another?
	\item Which techniques support compile-time variability, features, product generation, feature traceability, interfaces between features, reduction of code duplication, modularization of crosscutting concerns?
}{
	\item How to introduce a product line?
	\item What are strategies for product-line adoption?
	\item What are (dis)advantages of product-line adoption strategies?
	\item When to prefer one adoption strategy over another?
	\item Are combinations of adoption strategies feasible?
	\item What is the connection between process models and adoption strategies for product lines?
}

\input{template/footer}
