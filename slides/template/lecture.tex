\usepackage{../SoftVarE-SlideTemplate/beamerthemeuulm} % use the inofficial uulm beamer theme
\uulmlogos{,uulm,,unibe-flat-crop,,ovgu-blue,}
\setmycolumnsdefault{animation=keep} % animate all columns per default

\title{Software Product Lines} % short title is used for the slide footer but optional

% emphasizing links
\hypersetup{linkcolor = black, citecolor = black, filecolor = black, runcolor = black, urlcolor = red, colorlinks=true}

% UNIVERSITY-SPECIFIC ADJUSTMENTS
% or: a product line of product-line lectures ;-)
% usage: \def\university{ulm}

\expandafter\def\csname \university\endcsname{}
\newcommand{\foruniversity}[4][]{\ifdefined\bern#2\else\ifdefined\magdeburg#3\else\ifdefined\ulm#4\else#1\fi\fi\fi}

\let\originalauthor\author
\renewcommand{\author}[1]{
	\foruniversity[\originalauthor{#1}]
		{\originalauthor{Timo Kehrer, Sandra Greiner}}
		{\originalauthor{Gunter Saake, Elias Kuiter}}
		{\originalauthor{Thomas Thüm, Chico Sundermann}}
}

\newcommand{\inputforuniversity}[1]{
	\foruniversity
		{\input{#1bern}}
		{\input{#1magdeburg}}
		{\input{#1ulm}}
}

% GRAPHICSPATH

\makeatletter
\newcommand{\setpaths}[1]{
	\graphicspath{#1} % for loading pictures
	\def\input@path{#1} % for loading picture sources
}
\makeatother

% load href target from file: \href{file.txt}{text}
\newcommand\hreffile[1]{%
	\CatchFileDef\myurl{#1}{\catcode`\#=12\catcode`\%=12\endlinechar=-1}%
	\expandafter\href\expandafter{\myurl}}
\newcommand{\pic}[2][]{%
	\IfFileExists{#2.txt}{\hreffile{#2.txt}}{}{\includegraphics[#1]{#2}}}

\setpaths{
	{../SoftVarE-SlideTemplate/pics/logos/}
	{../SoftVarE-SlideTemplate/pics/nature/}
	{../SoftVarE-SlideTemplate/pics/uulm/}
	{../SoftVarE-Papers/}
	{../SoftVarE-Slides/}
	{../pics/}
	{../pics/bikes/}
	{../pics/buildsystems/}
	{../pics/cars/}
	{../pics/cloneandown/}
	{../pics/configurators/}
	{../pics/elevators/}
	{../pics/frameworks/}
	{../pics/graphs/}
	{../pics/interactions/}
	{../pics/linux/}
	{../pics/literature/}
	{../pics/lego/}
	{../pics/logos/}
	{../pics/magdeburg/}
	{../pics/mindmaps/}
	{../pics/people/}
	{../pics/preprocessors/}
	{../pics/products/}
	{../pics/projectcartoon/}
	{../pics/runtimevariability/}
	{../pics/services/}
	{../pics/testing/}
	{../pics/variabilitymodels/}
	{../pics/versioncontrol/}
	{../pics/xkcd/}
	{../EagleoutIce-fancyqr/}
}

% IMPORTED PACKAGES

\usepackage{multicol} % used temporarily for the lecture overview
\usepackage{stmaryrd} % \lightning in modeling lecture
\usepackage{catchfile} % read picture sources from files
\usepackage{silence} % ignore some warnings
\WarningFilter{latex}{You have requested package} % ignore warning for loading packages from submodules
\usepackage{fancyqr} % QR codes for practice task, credits to Florian Sihler

% INCLUDED TEMPLATE FILES

\input{template/colorscheme}
\input{template/macros}
\input{template/featurediagrams} % TODO merge into template?
\input{template/listings} % TODO merge into template?

% LINKED LITERATURE

\newcommand{\backgroundcolors}{\href{https://link.springer.com/article/10.1007/s10664-012-9208-x}{Feigenspan~et~al.~2013}}
\newcommand{\bakarnaturallanguage}{\href{https://doi.org/10.1016/j.jss.2015.05.006}{Bakar~et~al.~2015}}
\newcommand{\batorygrammars}{\href{https://link.springer.com/chapter/10.1007/11554844_3}{Batory~2005}}
\newcommand{\czarneckithereandbackagain}{\href{https://ieeexplore.ieee.org/document/4339252}{Czarnecki~and~Wasowski~2007}}
\newcommand{\cide}{\href{https://wwwiti.cs.uni-magdeburg.de/iti_db/forschung/cide/}{CIDE}}
\newcommand{\dimacsformat}{\href{https://beyondnp.org/static/media/uploads/docs/satformat.pdf}{DIMACS~1993}}
\newcommand{\evaluatingsharpsatsolverslink}[1]{\href{https://github.com/SoftVarE-Group/Papers/raw/main/2020/2020-VaMoS-Sundermann.pdf}{#1}}
\newcommand{\evaluatingsharpsatsolvers}{\evaluatingsharpsatsolverslink{Sundermann~et~al.~2020}}
\newcommand{\essentialconfigurationcomplexitylink}[1]{\href{https://github.com/SoftVarE-Group/Papers/raw/main/2016/2016-ASE-Meinicke.pdf}{#1}}
\newcommand{\essentialconfigurationcomplexity}{\essentialconfigurationcomplexitylink{Meinicke~et~al.~2016}}
\newcommand{\featureide}{\href{https://link.springer.com/book/10.1007\%2F978-3-319-61443-4}{Meinicke~et~al.~2013}}
\newcommand{\featurecommander}{\href{https://www.tu-chemnitz.de/informatik/ST/research/material/xenomai/}{Feature~Commander}}
\newcommand{\fospl}{\href{https://link.springer.com/book/10.1007/978-3-642-37521-7}{Apel~et~al.~2013}}
\newcommand{\foda}{\href{https://resources.sei.cmu.edu/library/asset-view.cfm?assetid=11231}{Kang~et~al.~1990}}
\newcommand{\gof}{\href{https://learning.oreilly.com/library/view/design-patterns-elements/0201633612/}{Gang of Four}}
\newcommand{\icpl}{\href{https://dl.acm.org/doi/10.1145/2362536.2362547}{Johansen~et~al.~2012}}
\newcommand{\lehmanslaws}{\href{https://ieeexplore.ieee.org/iel3/5031/13795/00637156.pdf}{Lehman et al.\ 1997}}
\newcommand{\ludewiglichter}{\href{https://learning.oreilly.com/library/view/-/9781457184932/?ar}{Ludewig and Lichter}}
\newcommand{\reducingconfigurations}{\href{https://doi.org/10.1145/1960275.1960284}{Kim~et~al.~2011}}
\newcommand{\samplingsurvey}{\href{https://github.com/SoftVarE-Group/Papers/raw/main/2018/2018-SPLC-Varshosaz.pdf}{Varshosaz~et~al.~2018}}
\newcommand{\seeconomics}{\href{https://rds-ulm.ibs-bw.de/link?kid=027381854}{SE Economics}}
\newcommand{\seiwhitepaperspl}{\href{https://resources.sei.cmu.edu/asset_files/WhitePaper/2012_019_001_495381.pdf}{Northrop~et~al. 2012}}
\newcommand{\shereverseengineering}{\href{https://dl.acm.org/doi/abs/10.1145/1985793.1985856}{She~et~al.~2011}}
\newcommand{\softwareclonedetection}{\href{https://www.sciencedirect.com/science/article/abs/pii/S0950584913000323}{Rattan~et~al.~2013}}
\newcommand{\sommervillelink}[1]{\href{https://ulm.ibs-bw.de/aDISWeb/app?service=direct/0/Home/$DirectLink\&sp=SOPAC00\&sp=SAKSWB-IdNr1615420983}{#1}}
\newcommand{\sommerville}{\sommervillelink{Sommerville}}
\newcommand{\sple}{\href{https://link.springer.com/book/10.1007/3-540-28901-1}{Pohl~et~al.~2005}}
\newcommand{\thehumbleprogrammer}{\href{https://dl.acm.org/doi/10.1145/1283920.1283927}{The Humble Programmer}}
\newcommand{\thepragmaticprogrammer}{\href{https://learning.oreilly.com/library/view/the-pragmatic-programmer/9780135956977/}{The Pragmatic Programmer}}
\newcommand{\twodimensionalanalysislink}[1]{\href{https://github.com/SoftVarE-Group/Papers/raw/main/2019/2019-VariVolution-Thuem.pdf}{#1}}
\newcommand{\twodimensionalanalysis}{\twodimensionalanalysislink{Thüm~et~al.~2019}}
\newcommand{\universitycourses}{\href{https://link.springer.com/chapter/10.1007/978-3-030-30446-1_7}{Bittner~et~al.~2019}}
\newcommand{\virtualseparation}{\href{https://www.cs.cmu.edu/~ckaestne/pdf/diss_kaestner_virtual_separation_of_concerns.pdf}{Kästner~2010}}

% REFERENCES TO OTHER LECTURES

\newcommand{\reflecture}[1]{(see~Lecture~#1)}
\newcommand{\lectureintroduction}{\reflecture{1}}
\newcommand{\lectureruntime}{\reflecture{2}}
\newcommand{\lecturecloneandown}{\reflecture{3}}
\newcommand{\lecturemodeling}{\reflecture{4}}
\newcommand{\lecturefeatures}{\reflecture{5}}
\newcommand{\lecturemodules}{\reflecture{6}}
\newcommand{\lecturelanguages}{\reflecture{7}}
\newcommand{\lectureprocess}{\reflecture{8}}
\newcommand{\lectureinteractions}{\reflecture{9}}
\newcommand{\lectureanalyses}{\reflecture{10}}
\newcommand{\lecturetesting}{\reflecture{11}}
\newcommand{\lectureevonance}{\reflecture{12}}

% TODO remove old lecture names (consistently across all files)
\newcommand{\lectureembedded}{\lecturefeatures}
\newcommand{\lectureapps}{\lecturemodules}

% HACKS TO WORKAROUND PROBLEMS WITH THE TEMPLATE

% TODO command to add extra space after each section manually
\newcommand{\sectionend}{\addtocontents{toc}{\vspace{2mm}}}

% TODO hack to switch the lecture title with its subtitle on the title slide + add photo copyright notice
\makeatletter
\setbeamercolor{copyrightbox}{fg=white}
\renewcommandx{\maketitle}[2][1=apr21-o25a,2=150]{
    {
    \def \picture {#1}
    \ifx \picture \empty \else \usebackgroundtemplate{\pic[trim=0 0 0 #2,clip,width=\paperwidth]{#1}} \fi
    \begin{frame}[plain]
        \vskip0pt plus 1filll
		\begin{beamercolorbox}[wd=\paperwidth,ht=2.25ex,dp=1ex,left]{copyrightbox}
            \tiny
			\ifdefined\thecopyright
				\hspace{1mm}\thecopyright
			\fi
        \end{beamercolorbox}%
        \begin{beamercolorbox}[wd=\paperwidth,ht=4.5ex,dp=2ex,right]{titlebox}
            \LARGE\textbf{\insertsubtitle}\hspace*{20pt}
        \end{beamercolorbox}%
        \nointerlineskip%
		\begin{beamercolorbox}[wd=\paperwidth,ht=2.25ex,dp=1ex,right]{subtitlebox}
            \small
            \inserttitle\ $\vert$
            \insertauthor\
            \ifx \insertdate \empty \else $\vert$ \insertdate \fi
            \hspace*{20pt}
        \end{beamercolorbox}%
        \nointerlineskip
        \begin{beamercolorbox}[wd=\paperwidth,ht=4.5ex,dp=2ex,left]{logobox}
            \vspace{-1ex}%
            \hspace{10pt}
            \@mainlogo
            \hspace{10pt}
        \end{beamercolorbox}%
    \end{frame}
    }
}
\makeatother

% TODO
\renewcommand{\contentoverview}{
    \begin{frame}{\inserttitle\ -- \insertsubtitle}
        \linespread{.5}
        \vfill
        \begin{multicols}{2}
            \tableofcontents
        \end{multicols}
    \end{frame}
}

% TODO merge into template
% automatic frame title
\newcommand{\myframetitle}{\insertsubsection{}\ifnum\thesubsubsection=0\else\ -- \insertsubsubsection{}\fi}
% setter for title picture + copyright notice
\newcommand{\setpicture}[2][150]{\def\thepicture{#2}\def\thepictureoffset{#1}}
\newcommand{\setcopyright}[1]{\def\thecopyright{#1}}

% TODO improve itemize + enumerate margins
% \setlength{\leftmargini}{3ex}
% \setbeamertemplate{enumerate item}{\makebox[.5\labelwidth][l]{\insertenumlabel.}}

% TODO: add reference slide at the end for picture licenses
% TODO: QR codes for uploading practice solutions